# cubic spline

给定点序列
- $\{P_0,P_1,\cdots,P_m\}$,其中 $P_i=(x_i,y_i)$

三次样条(cubic spline)的任务是
- 每个区间 $[P_i,P_{i+1}]$ 内定义一个多项式，使其经过每个点并保持一定连续性

假设在每个区间 $[P_i,P_{i+1}]$ 内都定义一个 $t\in[0,1]$,定义三次多项式参数方程

$$
\begin{align}
x&=f_i(t)=a_i t^3+b_it^2+c_it+d_i\\
y&=g_i(t)=e_i t^3+f_it^2+g_it+h_i
\end{align}
$$

对于区间 $[P_i,P_{i+1}]$ 的 $x$ 参数我们需要求解 $4$ 个未知数，整个序列有 $m$ 个区间，所以对于整个序列一共需要求解 $4m$ 个未知数，对应的需要列出 $4m$ 个方程进行求解

- 要求一

每个区间必须经过左右两个端点，即

$$
f_i(0)=x_i,f_i(1)=x_{i+1},i=0,1,\cdots,m-1
$$

共 $2m$ 个方程

- 要求二

相邻区间的衔接点，要求连续，即

$$
f^{'}_i(1)=f^{'}_{i+1}(0),f^{''}_i(1)=f^{''}_{i+1}(0),i=0,1,\cdots,m-2
$$

共 $2(m-1)$ 个方程

> 目前一共有 $4m-2$ 个方程，对于剩下两个方程我们可以自己选定，一般选择为起点和终止点的二阶导为0，

$$
f^{''}_0(0)=0,f^{''}_{m-1}(1)=0
$$

如此便凑够了 $4m$ 个方程可以用于求解三次样条的参数方程。

[code](/Spline/code/2_cubic_spline.py)

## 特点
- 移动了某一个控制点就需要重新求解整个曲线，与贝塞尔曲线均具有非局部性

## 参考

- [6.2. 样条曲线](https://vcl-pku.github.io/vci-book/getting-started/curves/curve-spline.html)