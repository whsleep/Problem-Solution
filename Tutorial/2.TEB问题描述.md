# TEB问题描述

## 问题定义

- 二维空间给定起点和目标点姿态

`Star_PoseSE2 = [0, 0, 0]`
`End_PoseSE2 = [2, 2, pi/3]`

- 在`[[0.5, 0.75], [1.5, 1.25]]`处有两个点障碍,

`Obs_Pose=[[0.5, 0.75], [1.5, 1.25]]`

- 最大速度限制

$$
v<v_{max}\\
\omega \le \omega_{max}
$$

- 底盘为 `car_like`模型 [tricycle_dynamics](/Kinetics/tricycle_Kinetics.md)

**求解连接起点和目标点在与障碍保证安全的前提下, 轨迹长度相对短, 轨迹耗时相对少且符合运动学模型的轨迹序列**

## 问题描述

### 条件

需要在起点和目标点之间生成指定`SIZE=n`个轨迹点

### 变量定义

- 定义轨迹序列 $\mathbf{X} = \{ \mathbf{x}_i \}_{i=0}^{n+1}$，其中 $\mathbf{x}_i = [x_i, y_i, \theta_i]$ 表示第 $i$ 个轨迹点的位置，满足以下边界条件：

$$
\mathbf{x}_0 = [0, 0, 0], \quad \mathbf{x}_{n+1} = [2, 2, \pi/3]
$$

- 定义障碍序列$\mathbf{O}=\{\mathbf{o}_j \}_{j=0}^m$，其中 $\mathbf{o}_j = [x_j, y_j]$ 表示第 $j$ 个障碍点的位置

- 定义相邻轨迹点时间差 $\mathbf{T} = \{ \Delta T_i \}_{i=0}^{n}$, 其中 $\Delta T_i$ 表示轨迹点 $\mathbf{x}_i, \mathbf{x}_{i+1}$ 之间的时间差

### 约束

- 生成的路径点构成的总长度尽量短

$$
f_{path}(\mathbf{x}_i)=||\mathbf{x}_i-\mathbf{x}_{i+1}||,\quad i\in[0,1,...,n]
$$

- 轨迹耗时相对短

$$
f_{T}(\Delta T_i)=\Delta T_i,\quad i\in[0,1,..,n]
$$

- 生成的路径点障碍物保持安全距离`Safe_Dis = 0.3m`

$$
f_{safe}(\mathbf{x}_i, \mathbf{o}_j)=max \left( 0,Safe\_Dis-||\mathbf{x}_i - \mathbf{o}_j||\right),\quad i\in[1,2,...,n]
$$

> 这里指定 $\mathbf{o}_j$ 为距离轨迹点 $\mathbf{x}_i$ 最近的障碍点

- 生成的相邻轨迹点需要满足最大线速度和角速度要求

$$
\begin{align}
v_i&=\frac{||\mathbf{x}_{i+1}-\mathbf{x}_i||}{\Delta T_i}\\
\omega_i&=\frac{Normalize(\theta_{i+1}-\theta_i)}{\Delta T_i}\\
i&\in[0,1,...,n]
\end{align}
$$

`Normalize()`将角度差值限制在$[-\pi, \pi]$内

$$
\begin{align}
f_{v}(v_i)&=max \left(0, v_i - v_{max} \right)\\
f_{\omega}(\omega_i)&=max \left(0, \omega_i - \omega_{max} \right)
\end{align}
$$

- 运动学非完整约束
